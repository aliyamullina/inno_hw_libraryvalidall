# tox (https://tox.readthedocs.io/) is a tool for running tests
# in multiple virtualenvs. This configuration file will run the
# test suite on all supported python versions. To use it, "pip install tox"
# and then run "tox" from this directory.

[tox]
envlist = py39
skipsdist=True

[flake8]
exclude = tests, .tox, venv, .mypy_cache
ignore = D100, D104, D105, D106, W503, E203, E231, D401
per-file-ignores = test_*.py: D101,D102,N802

[testenv]
deps =
    -r requirements.txt
envdir = {toxworkdir}/venv/{envname}
setenv =
       PYTHONDONTWRITEBYTECODE=1
commands =
    black main.py
    black exceptions.py

    # Формат кода соответствует pep8:
    flake8 --max-line-length=120 main.py

    # Формат докстрингов соответствует pep 257:
    flake8 --docstring-convention=pep257 main.py

    # Формат аннотаций соответствует pep 484:
    mypy --follow-imports=skip main.py --disallow-untyped-calls --disallow-untyped-defs --disallow-incomplete-defs --check-untyped-defs  --disallow-untyped-decorators --ignore-missing-imports --pretty

    # Отсутствует мертвый код:
    vulture main.py --min-confidence 70

    radon mi -m . -e "venv/*"

    pytest -v test_main.py